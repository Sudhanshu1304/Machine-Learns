{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <title>Encoder Size</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/encodersize.css' %}">
  </head>
  <body>
      
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


    <div class="container-fluid cont1">


        
        <div class="container cont2">

            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>
                <a class="navbar-brand" href="/"><strong>Machine Learns</strong> </a>
              
                <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                  <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                        <li class="nav-item active">
                        <a class="nav-link" href="/encoder">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blogs">Blogs</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">API</a>
                        </li>
                        
                  </ul>
                
                </div>
            </nav>
            <!-- Lower body Jumbo-->
            <div class="jumbotron jumbotron-fluid">
                <div class="container">
                    <h1 class="display-5">Image Compresion Demonstraction</h1>
                    <p class="lead"><h4 class="display-6">Experimentation Lab  </h4></p>
                    <hr class="my-2">
                    <p>Here you will learn how autoencoders perform in different configrations and its various aspects</p>
                    <p class="lead">
                      
                    </p>
                </div>
            </div>
            
         
            
            <!-- Lower body Jumbo-->

            <div class="row">

                <div class="col-lg-6">
                    
                    <div class="card cousalcard" style="height: 50vh;">
                        <div class="card-header">
                            Applications
                        </div>
                        <div class="card-body">
                           
                            <p class="card-text">
                                <div id="carouselId" class="carousel slide" data-ride="carousel">
                                    <ol class="carousel-indicators">
                                        <li data-target="#carouselId" data-slide-to="0" class="active"></li>
                                        <li data-target="#carouselId" data-slide-to="1"></li>
                                        
                                    </ol>
                                    <div class="carousel-inner" role="listbox">
                                        <div class="carousel-item active">
                                            <img src="{% static 'images/comp1.jpg' %}" height="200px" width="100%" alt="First slide">
                                            
                                            
                                        </div>
                                        <div class="carousel-item">
                                            <img src="{% static 'images/comp2.png' %}" height="200px" width="100%" alt="Second slide">
                                          
                                        </div>
                                       
                                    </div>
                                    <a class="carousel-control-prev" href="#carouselId" role="button" data-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                    <a class="carousel-control-next" href="#carouselId" role="button" data-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </div>
                            </p>
                        </div>
                       
                    </div>
                </div>
                <div class="col-lg-6">

                    <div class="container" style="padding-top: 20px;">

                        <p> 
                            Using autoencoders we can compress a image of size <strong>28X28 (784 pixles)</strong>  into <strong>4X4 (16 pixles)</strong> . Basically they can transform a high-dimensional space to a lower dimensional space. <br>
                            In this model, input and output is the same image. <br>
                        </p>
                        <p>
                            The encoder first encodes the original image into a lower dimensional <strong>encoding</strong> which is then decoded by th decoder to form the real image. <br>
                            Here the loss function tries to miminize the differene between teh input and the output image. And hense we get a decoder which can create original image from the encoding.
    
                        </p>

                        <p>
                            This Lab consists of pretrained models for you to tinker with. The models are trained on <strong> 
                                Mnist Handwritten digits and Mnist Fashion datasets
                               </strong>
                        </p>
                        
                    </div>

                    

                    
                    
                    
                </div>
            </div>

            

            <!-- Card View section-->
            <div class="container-fluid " >
                
                <header>
                    <h2 class="sect1" style="padding-top: 50px;"><strong>Tinker Section</strong></h2> 
                </header>


                <div class="container-fluid">
                    
                   
                        
                        <p style="padding:5px">
                            

                            <ul>
                                <li>
                                    <strong>Step 1</strong>  : Select any dataset ( Fashion | Digits ).
                                </li>
                                <li>
                                    <strong>Step 2</strong>  : Choose a Image.
                                </li>
                                <li>
                                    <strong>Step 3</strong>  : Select a Model ( CNN | DNN ) 
                                </li>
                                <li>
                                    <strong>Step 4</strong>  : Hit Submit and you can see the Results
                                </li>
                            </ul>
        
                        </p>
                    
                </div>

            <div class="row row1 bottom" >
               
                
                <div class="col-md-7" style="max-height: fit-content;" >
                    
                    <!-- //<div class="row"> -->
                        <div class="card" style="width: 100%;margin-top: 10px;">
                            <div class="card-header">
                                <ul class="nav nav-tabs" id="myTab" role="tablist">
                                   
                                    <li class="nav-item">
                                      <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true"><strong>DNN</strong></a>
                                    </li>
                                    <li class="nav-item">
                                      <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false"><strong>CNN</strong></a>
                                    </li>
                                    <li class="nav-item">
                                        <a  class="nav-link disabled">
                                            <strong>Model Selection</strong> 
                                        </a>
                                    </li>
                                  </ul>
                            </div>
                         
                            <div class="card-body modelselect">
                                <div class="tab-content" id="myTabContent">
                                    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
    
                                        
    
                                            <div class="form-check" >
                                           
                                                <div class="row  list-group-item list-group-item-action list-group-item-light">
                                                    <input class="form-check-input model" type="radio" name="exampleRadios" id="exampleRadios1" value="DNN_1_64_" checked>
                                                    <label class="form-check-label model2" for="exampleRadios1">
                                                        Bottelneck - 64  Hidden layers - 1
                                                    </label>
                                                </div>
                                                <div class="row  list-group-item list-group-item-action list-group-item-light">
                                                    <input class="form-check-input model" type="radio" name="exampleRadios" id="exampleRadios2" value="DNN_1_8_">
                                                    <label class="form-check-label model2" for="exampleRadios2">
                                                        Bottelneck - 8  Hidden layers - 1
                                                    </label>
                                                </div>
                                                
                                                <div class="row  list-group-item list-group-item-action list-group-item-light">
                                                    <input class="form-check-input model " type="radio" name="exampleRadios" id="exampleRadios3" value="DNN_2_8_">
                                                    <label class="form-check-label model2 " for="exampleRadios3">
                                                        Bottelneck - 8  Hidden layers - 2
                                                    </label>
        
                                                </div>
                                               
                                                
                                            
        
                                            </div>
                                         
                                        
                                        
                                    </div>
                                    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                                                
                                                <div class="row  list-group-item list-group-item-action list-group-item-light">
                                                    <input class="form-check-input model" type="radio" name="exampleRadios" id="exampleRadios11" value="CNN_1_64_" checked>
                                                    <label class="form-check-label model2" for="exampleRadios11">
                                                        Bottelneck - 64  Hidden layers - 1
                                                    </label>
                                                </div>
                                                <div class="row  list-group-item list-group-item-action list-group-item-light">
                                                    <input class="form-check-input model" type="radio" name="exampleRadios" id="exampleRadios22" value="CNN_1_8_">
                                                    <label class="form-check-label model2" for="exampleRadios22">
                                                        Bottelneck - 8 Hidden layers - 1
                                                    </label>
                                                </div>
                                                
                                               
                                    </div>
                                   
                                  </div>
                            </div>
                            <div class="card-footer text-muted">
                                <button class="btn btn-primary data" id="subbut"  type="submit" >Submit</button>
                            </div>
    
                            
                       
                        </div>
                    <!-- </div> -->
                </div>

                <div class="col-md-5" style="max-height: fit-content;">
                    
                    <!-- <div class="row rowimg"> -->
                        
                        <div class="card" style="width: 100%;margin-top: 10px;">
                            <div class="card-header">
                                    <button class="btn btn-primary changeimg" type="submit"    id='mainimgbut' >
                                        Change Image
                                    </button>   
                                    
                                    <!-- <button class="btn btn-primary changeimg" type="submit"         id='mainimgbut' >
                                        Add Noice
                                    </button>    -->

                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <img src="" id ='mainimg' height='300px' width="100%" >
                                </div>
                            </div>
                            <div class="card-footer text-muted">
                                <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                            
                                            <label class="btn btn-outline-dark active">
                                                <input type="radio" name="options" id="option1" value='digits' onclick="firstimg(this.id)" autocomplete="off" checked> Digits
                                            </label>
                                            <label class="btn btn-outline-dark">
                                                <input type="radio" name="options" id="option2" onclick="firstimg('fashion')" value = 'fashion' autocomplete="off"> Fashion
                                            </label>
                                          
                                        
                                        </div>
                            </div>
                        </div>
                                    

                    <!-- </div> -->

                   
                            
                   
                                

                </div>


                <div class="container-fluid " id="result_togle" style="display: none;" >
                    <header>
                        
                        <h2 class="sect1"><strong>Results</strong></h2> 
                    </header>
                 

                    <div class="row resultsec" style="margin-top: 15px;">
                        <div class="col-lg-6">
                            
                            <div class="card" style="width: 100%;margin-top: 15px;">
                                <div class="card-header">
                                    <strong>Latent Space</strong>
                                </div>
                                <div class="card-body">
                                    <img src="" id='refimg' height="300px" width="100%" >
                                </div>
                                <div class="card-footer text-muted">
                                    Footer
                                </div>
                            </div>
                             
                        </div>
                        <div class="col-lg-6">
                            
                            <div style="width: 100%;margin-top: 15px;" >
                                <p>
                                    <strong>Latent</strong> means <strong>hidden</strong> i.e Hidden Representation.
                                    Latent space is a compresed representation of our original data. It store  importent characteristics ( features ) of the input data.
                                </p>
                                <p>
                                    In the graph of the latent space we can see that there are groups of similar colors . These points represents individual data points ( Numbers|Clothes in our case ).
                                    For example,  a individual  red dot may represet <strong>9</strong> and  blue dot as <strong>6</strong> e.t.c .
    
    
                                </p>
    
                                <p>
                                    
                                    You will notice that latent representation with bottleneck dimensions <strong>( 64X64 )</strong>
                                    is clustered in a small region without any proper distingstion , this is because we are ploting a <strong>64 </strong> dimensional plot in a <strong>2</strong> dimensional graph.
                                    
                                    Hence if you choose a model with bottelneck as <strong>2D</strong>, you will be able to see the distingstion properly (the predicted image will not be good enoug though as we will loose a lot of information).
                                </p>
                            </div>
                            
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card" style="margin-top: 15px;">
                                <div class="card-header">
                                    Originl Image
                                </div>
                                <div class="card-body">
                                    <img src="" id='mainimg2' height="300px" width="100%"  >
                                </div>
                                <div class="card-footer text-muted">
                                    Footer
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card" style="margin-top: 15px;">
                                <div class="card-header">
                                    Bottleneck
                                </div>
                                <div class="card-body">
                                    <img src="" id='botneck' height="300px" width="100%"  >
                                </div>
                                <div class="card-footer text-muted">
                                    Footer 
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card" style="margin-top: 15px;">
                                <div class="card-header">
                                    Predicted Image
                                </div>
                                <div class="card-body">
                                    
                                    <img src="" id='predimg' height="300px" width="100%"  >
                                </div>
                                <div class="card-footer text-muted">
                                    Footer
                                </div>
                            </div>
                        </div>
                    </div>






                </div>


                
            </div>
            
            


        </div>




            </div>
            



    </div>



    <script>



    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    const csrftoken = getCookie('csrftoken');
        
        option = 'Digit';
        async function firstimg(){
            // This function is for the the original Image https://machine-learns.herokuapp.com/api/img
            reset();
           
            const data = await fetch('/api/img/',{
                method:"POST",
                credentials: "same-origin",
                headers: {
                    'Accept': 'application/json',
                    "Content-type": "application/json;charset=UTF-8",
                    "X-CSRFToken": csrftoken,
                    'X-Requested-With': 'XMLHttpRequest',
                },
                body: JSON.stringify({"opt":option,'noice':'False'}),
                

            });
            const d2 = await data.json();
            var val = d2['org'];
          
            mainimg = d2['mainimg']
            val = JSON.parse(val);
            mainimg = JSON.parse(mainimg);

            fir = 'data:image/png;base64,';
            str = fir.concat(val);
            document.getElementById('mainimg').setAttribute(
                'src',str,
                
            );
           
            document.getElementById('mainimg2').setAttribute(
                'src',str
            );
      
        };

        $('#mainimgbut').click(function call(){
            firstimg();
        });
        
        $('#option1').change(function() {
            option = 'Digit';
            firstimg();
        });
        $('#option2').change(function() {
            option = 'Fashion';
            firstimg();
        }); 
        $(document).ready(function(){
            firstimg();
        })


        //refimg 

        async function otherimg(){
            // This function is for the the original Image
           
            var name = $("input[name='exampleRadios']:checked").attr("value");
            var list = name.split("_");
           
            var len = list.length;
            var size = list[len-2];

            obj = JSON.stringify({"name":name,"size":size,'page':option,'orgimg':mainimg,'type':"Clean"});
            var data = await fetch('/api/',{

                method:"POST",
                credentials: "same-origin",
                headers: {
                    'Accept': 'application/json',
                    "Content-type": "application/json;charset=UTF-8",
                    "X-CSRFToken": csrftoken,
                    'X-Requested-With': 'XMLHttpRequest',
                },
                body: obj,
            
            
            });
            var d2 = await data.json();
         
            var val = d2['rep_img'];
            var orgimg = d2['img'];
            var botneck = d2['bot'];
            
            orgimg = JSON.parse(orgimg);
            val = JSON.parse(val);
            botneck = JSON.parse(botneck);


            fir = 'data:image/png;base64,';
            str = fir.concat(val);
            str2 = fir.concat(orgimg);
            str3 = fir.concat(botneck);

            document.getElementById('refimg').setAttribute(
                'src',str
            );

            document.getElementById('predimg').setAttribute(
                'src',str2
            );

            document.getElementById('botneck').setAttribute(
                'src',str3
            );
           
      
        };

        $('#subbut').click(function call(){
            otherimg();
            document.getElementById('result_togle').style.display='block';
        });


        function reset() {
            document.getElementById('result_togle').style.display='none';
        }

       

        
    </script>


  </body>
</html>